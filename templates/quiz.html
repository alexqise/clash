{% extends 'base.html' %}

{% block content %}
<!-- Quiz page content -->
<div class="card mx-auto" style="max-width: 500px;">
    <div class="card-body">
        <h2 class="card-title">Quiz</h2>
        <p class="fw-bold">{{ question.question }}</p>
        <!-- Required image -->
        <!-- Optional GIF/Video placeholder -->
        {% if question.media_placeholders.gif.endswith('.mp4') %}
        <!-- Render video if URL is mp4 -->
        <video src="{{ question.media_placeholders.gif }}" class="img-fluid mb-2" controls loop muted playsinline style="max-width:100%;height:auto;">
            Your browser does not support the video tag.
        </video>
        {% else %}
        <!-- Render image if URL is gif or other -->
        <img src="{{ question.media_placeholders.gif }}" class="img-fluid mb-2" alt="GIF/Video coming soon!">
        {% endif %}
        <!-- Audio removed for quiz simplicity -->
        <!-- Answer form -->
        <form method="post">
            <div class="mb-3">
                {% for option in question.options %}
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="option" id="option{{ loop.index0 }}" value="{{ loop.index0 }}" {% if answer == loop.index0 %}checked{% endif %} {% if feedback is not none %}disabled{% endif %}>
                    <label class="form-check-label" for="option{{ loop.index0 }}">{{ option }}</label>
                </div>
                {% endfor %}
            </div>
            {% if feedback is not none %}
                {% if feedback %}
                    <div class="alert alert-success" role="alert">Correct! Well done.</div>
                {% else %}
                    <div class="alert alert-danger" role="alert">Incorrect. Try to review the lesson!</div>
                {% endif %}
            {% endif %}
            <div class="d-flex justify-content-between">
                <button type="submit" name="action" value="prev" class="btn btn-secondary" aria-label="Previous Question" {% if progress[0] == 1 %}disabled{% endif %}>Previous</button>
                <button type="submit" name="action" value="answer" class="btn btn-success" aria-label="Submit Answer" {% if feedback is not none %}disabled{% endif %}>Submit</button>
                <button type="submit" name="action" value="next" class="btn btn-primary" aria-label="Next Question" {% if progress[0] == progress[1] %}disabled{% endif %}>Next</button>
            </div>
        </form>
        <!-- Progress bar -->
        <div class="progress my-3" aria-label="Quiz progress">
            <div class="progress-bar" role="progressbar" style="width: {{ (progress[0] / progress[1]) * 100 }}%;" aria-valuenow="{{ progress[0] }}" aria-valuemin="1" aria-valuemax="{{ progress[1] }}">
                Question {{ progress[0] }} / {{ progress[1] }}
            </div>
        </div>
    </div>
</div>
{% endblock %} 